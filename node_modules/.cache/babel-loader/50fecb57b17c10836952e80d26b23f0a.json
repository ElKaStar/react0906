{"ast":null,"code":"import _toConsumableArray from\"C:\\\\Users\\\\licos\\\\WebstormProjects\\\\react\\\\react0906\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"C:\\\\Users\\\\licos\\\\WebstormProjects\\\\react\\\\react0906\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import{getUsers,setFollow,setUnfollow}from\"../API/api\";var NEXT_USERS='NEXT-USERS';var LAST_USERS='LAST-USERS';var FOLLOW='FOLLOW';var SET_USERS='SET-USERS';var SET_CURRENT_PAGE='SET-CURRENT-PAGE';var SET_FETCHING='SET-FETCHING';var GET_CURRENT_USER_ID='GET-CURRENT-USER-ID';var SET_FOLLOWING_IN_PROGRESS='SET-FOLLOWING-IN-PROGRESS';var initialState={users:[],pagingSize:4,startPosition:0,totalUsersCount:0,currentPage:1,isFetching:false,currentUserID:2,followingInProgress:[9069]};var usersReducer=function usersReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case NEXT_USERS:{if(state.currentPage<=Math.ceil(state.totalUsersCount/state.pagingSize)){return _objectSpread(_objectSpread({},state),{},{currentPage:state.currentPage+1});}else{alert(\"Пользователей больше нет\");return state;}}case LAST_USERS:{if(state.currentPage>1){return _objectSpread(_objectSpread({},state),{},{currentPage:state.currentPage-1});}else{alert(\"Это начало списка\");return state;}}case FOLLOW:{var copyUsers=_toConsumableArray(state.users);copyUsers.map(function(item){if(item.id===action.id){item.follow=!item.follow;}});return _objectSpread(_objectSpread({},state),{},{users:copyUsers});}case SET_USERS:{var _copyUsers=_toConsumableArray(action.newUsers);var copyState=_objectSpread(_objectSpread({},state),{},{users:_copyUsers,totalUsersCount:action.totalUsersCount});return copyState;}case SET_CURRENT_PAGE:{return _objectSpread(_objectSpread({},state),{},{currentPage:action.newCurrentPage});}case SET_FETCHING:{return _objectSpread(_objectSpread({},state),{},{isFetching:action.isFetching});}case GET_CURRENT_USER_ID:{return _objectSpread(_objectSpread({},state),{},{currentUserID:action.currentUserID});}case SET_FOLLOWING_IN_PROGRESS:{var myArr=state.followingInProgress.filter(function(id){return id!==action.id;});console.log(myArr);return _objectSpread(_objectSpread({},state),{},{followingInProgress:action.isFetching?[].concat(_toConsumableArray(state.followingInProgress),[action.id]):state.followingInProgress.filter(function(id){return id!==action.id;})});}default:return state;}return state;};export var showNextUsers=function showNextUsers(){return{type:NEXT_USERS};};export var showLastUsers=function showLastUsers(){return{type:LAST_USERS};};export var addFollow=function addFollow(id){return{type:FOLLOW,id:id};};export var setUsers=function setUsers(newUsers,totalUsersCount){return{type:SET_USERS,newUsers:newUsers,totalUsersCount:totalUsersCount};};export var setCurrentPage=function setCurrentPage(newCurrentPage){return{type:SET_CURRENT_PAGE,newCurrentPage:newCurrentPage};};export var setFetching=function setFetching(isFetching){return{type:SET_FETCHING,isFetching:isFetching};};export var getCurrentUserID=function getCurrentUserID(id){return{type:GET_CURRENT_USER_ID,currentUserID:id};};export var setFollowingInProgress=function setFollowingInProgress(isFetching,id){return{type:SET_FOLLOWING_IN_PROGRESS,isFetching:isFetching,id:id};};export var getUsersThunkCreator=function getUsersThunkCreator(pageNumber,pageSize){return function(dispatch){dispatch(setFetching(true));getUsers(pageNumber,pageSize).then(function(response){var newArrUsers=[];response.items.map(function(item){newArrUsers.push({id:item.id,name:item.name,message:item.status===null?'':item.status,url:item.photos.small,follow:item.followed});});dispatch(setUsers(newArrUsers,response.totalCount));dispatch(setFetching(false));});};};export var setFollowThunkCreator=function setFollowThunkCreator(id){return function(dispatch){dispatch(setFollowingInProgress(true,id));setFollow(id).then(function(data){if(data.resultCode===0){dispatch(addFollow(id));}dispatch(setFollowingInProgress(false,id));});};};export var setUnfollowThunkCreator=function setUnfollowThunkCreator(id){return function(dispatch){dispatch(setFollowingInProgress(true,id));setUnfollow(id).then(function(data){if(data.resultCode===0){dispatch(addFollow(id));}dispatch(setFollowingInProgress(false,id));});};};export default usersReducer;","map":{"version":3,"sources":["C:/Users/licos/WebstormProjects/react/react0906/src/Redux/users-reducer.js"],"names":["getUsers","setFollow","setUnfollow","NEXT_USERS","LAST_USERS","FOLLOW","SET_USERS","SET_CURRENT_PAGE","SET_FETCHING","GET_CURRENT_USER_ID","SET_FOLLOWING_IN_PROGRESS","initialState","users","pagingSize","startPosition","totalUsersCount","currentPage","isFetching","currentUserID","followingInProgress","usersReducer","state","action","type","Math","ceil","alert","copyUsers","map","item","id","follow","newUsers","copyState","newCurrentPage","myArr","filter","console","log","showNextUsers","showLastUsers","addFollow","setUsers","setCurrentPage","setFetching","getCurrentUserID","setFollowingInProgress","getUsersThunkCreator","pageNumber","pageSize","dispatch","then","response","newArrUsers","items","push","name","message","status","url","photos","small","followed","totalCount","setFollowThunkCreator","data","resultCode","setUnfollowThunkCreator"],"mappings":"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","sourcesContent":["import {getUsers, setFollow, setUnfollow} from \"../API/api\";\r\n\r\n\r\nconst NEXT_USERS = 'NEXT-USERS';\r\nconst LAST_USERS = 'LAST-USERS';\r\nconst FOLLOW = 'FOLLOW';\r\nconst SET_USERS = 'SET-USERS';\r\nconst SET_CURRENT_PAGE = 'SET-CURRENT-PAGE';\r\nconst SET_FETCHING = 'SET-FETCHING';\r\nconst GET_CURRENT_USER_ID = 'GET-CURRENT-USER-ID'\r\nconst SET_FOLLOWING_IN_PROGRESS = 'SET-FOLLOWING-IN-PROGRESS'\r\n\r\n\r\nlet initialState = {\r\n    users: [],\r\n    pagingSize: 4,\r\n    startPosition: 0,\r\n    totalUsersCount: 0,\r\n    currentPage: 1,\r\n    isFetching: false,\r\n    currentUserID: 2,\r\n    followingInProgress: [9069]\r\n\r\n}\r\n\r\nconst usersReducer = (state = initialState, action) => {\r\n\r\n    switch (action.type) {\r\n        case NEXT_USERS: {\r\n\r\n            if (state.currentPage <= Math.ceil(state.totalUsersCount/state.pagingSize)) { return {\r\n                ...state,\r\n                currentPage: state.currentPage + 1\r\n            }} else {\r\n                alert(\"Пользователей больше нет\")\r\n                return state\r\n            }\r\n        }\r\n        case LAST_USERS: {\r\n            if (state.currentPage > 1) {return {\r\n                ...state,\r\n                currentPage: state.currentPage - 1\r\n            }} else {\r\n                alert(\"Это начало списка\")\r\n                return state\r\n            }\r\n        }\r\n        case FOLLOW: {\r\n           let copyUsers = [...state.users]\r\n            copyUsers.map((item) => {\r\n                if (item.id === action.id) {\r\n                   item.follow = !item.follow\r\n                }\r\n            } )\r\n            return {\r\n               ...state,\r\n                users: copyUsers\r\n            }\r\n        }\r\n        case SET_USERS: {\r\n           let copyUsers = [...action.newUsers]\r\n           let copyState = {\r\n                ...state,\r\n                users: copyUsers,\r\n               totalUsersCount: action.totalUsersCount\r\n            }\r\n            return copyState;\r\n        }\r\n        case SET_CURRENT_PAGE: {\r\n\r\n            return {\r\n                ...state,\r\n                currentPage: action.newCurrentPage\r\n            }\r\n        }\r\n        case SET_FETCHING: {\r\n            return {\r\n                ...state,\r\n                isFetching: action.isFetching\r\n            }\r\n        }\r\n        case GET_CURRENT_USER_ID: {\r\n            return {\r\n                ...state,\r\n                currentUserID: action.currentUserID\r\n            }\r\n        }\r\n        case SET_FOLLOWING_IN_PROGRESS: {\r\nconst myArr = state.followingInProgress.filter((id) => id !== action.id)\r\n            console.log(myArr)\r\n            return {\r\n                ...state,\r\n                followingInProgress: action.isFetching?\r\n                    [...state.followingInProgress, action.id]\r\n                    :state.followingInProgress.filter((id) => id !== action.id)\r\n            }\r\n        }\r\n        default:\r\n            return state;\r\n    }\r\n\r\n\r\n    return state\r\n}\r\nexport const showNextUsers = () => {\r\n\r\n    return (\r\n        {\r\n            type: NEXT_USERS\r\n        }\r\n    )\r\n}\r\nexport const showLastUsers = () => {\r\n\r\n    return (\r\n        {\r\n            type: LAST_USERS\r\n        }\r\n    )\r\n}\r\n\r\nexport const addFollow = (id) => {\r\n\r\n    return (\r\n        {\r\n            type: FOLLOW,\r\n            id: id\r\n        }\r\n    )\r\n}\r\n\r\nexport const setUsers = (newUsers, totalUsersCount) => {\r\n\r\n    return (\r\n        {\r\n            type: SET_USERS,\r\n            newUsers: newUsers,\r\n            totalUsersCount: totalUsersCount\r\n        }\r\n    )\r\n}\r\n\r\nexport const setCurrentPage = (newCurrentPage) => {\r\n\r\n    return (\r\n        {\r\n            type: SET_CURRENT_PAGE,\r\n            newCurrentPage: newCurrentPage\r\n        }\r\n    )\r\n}\r\n\r\nexport const setFetching = (isFetching) => {\r\n\r\n    return (\r\n        {\r\n            type: SET_FETCHING,\r\n            isFetching: isFetching\r\n        }\r\n    )\r\n}\r\n\r\nexport const getCurrentUserID = (id) => {\r\n\r\n    return (\r\n        {\r\n            type: GET_CURRENT_USER_ID,\r\n            currentUserID: id\r\n        }\r\n    )\r\n}\r\n\r\nexport const setFollowingInProgress = (isFetching, id) => {\r\n    return (\r\n        {\r\n            type: SET_FOLLOWING_IN_PROGRESS,\r\n            isFetching: isFetching,\r\n            id: id\r\n        }\r\n    )\r\n}\r\nexport const getUsersThunkCreator = (pageNumber, pageSize) => {\r\n    return (dispatch) => {\r\n\r\n        dispatch(setFetching(true))\r\n        getUsers(pageNumber, pageSize).then(response => {\r\n\r\n            let newArrUsers = []\r\n            response.items.map((item) => {\r\n                newArrUsers.push({\r\n                    id: item.id,\r\n                    name: item.name,\r\n                    message: (item.status === null ? '' : item.status),\r\n                    url: item.photos.small,\r\n                    follow: item.followed\r\n                })\r\n            })\r\n            dispatch(setUsers(newArrUsers, response.totalCount))\r\n            dispatch(setFetching(false))\r\n        })\r\n    }\r\n}\r\n\r\nexport const setFollowThunkCreator = (id) => {\r\n    return (dispatch) => {\r\n        dispatch(setFollowingInProgress(true, id))\r\n        setFollow(id).then(data => {\r\n            if (data.resultCode === 0) {\r\n                dispatch(addFollow(id))\r\n            }\r\n            dispatch(setFollowingInProgress(false, id))\r\n        })\r\n    }\r\n}\r\n\r\nexport const setUnfollowThunkCreator = (id) => {\r\n    return (dispatch) => {\r\n        dispatch(setFollowingInProgress(true, id))\r\n        setUnfollow(id).then(data => {\r\n            if (data.resultCode === 0) {\r\n                dispatch(addFollow(id))\r\n            }\r\n            dispatch(setFollowingInProgress(false, id))\r\n        })\r\n    }\r\n}\r\n\r\n\r\n\r\nexport default usersReducer"]},"metadata":{},"sourceType":"module"}